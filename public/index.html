
<!doctype html>

<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://distill.pub/template.v2.js"></script>
<!-- <script src="js/_distill/template.v2.js"></script> -->

  <!-- bootstrap -->
<!-- <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>

<script src="js/lib/webgl_utils/webgl-utils.js"></script>
<script src="js/lib/webgl_utils/initShaders2.js"></script>
<script src="js/lib/webgl_utils/MV.js"></script>
<script src="js/lib/numeric-1.2.6.js"></script>
<script src="js/lib/math.js"></script>
<script src="js/lib/lz-string.js"></script>
<script src="js/lib/d3/v5/d3.js"></script>

<script src="js/modules/utils.js"></script>
<script src="js/modules/constants.js"></script>
<script src="js/modules/GrandTour.js"></script>

<script src="js/modules/TeaserRenderer.js"></script>
<script src="js/modules/TeaserOverlay.js"></script>

<script src="js/modules/SoftmaxComparisonRenderer.js"></script>
<script src="js/modules/SoftmaxComparisonOverlay.js"></script>

<!-- <script src="js/modules/ConfusionMatrixRenderer.js"></script> -->

<script src="js/modules/TesseractRenderer.js"></script>
<script src="js/modules/TesseractOverlay.js"></script>

<!-- <script src="js/modules/NeuralNetRenderer.js"></script> -->
<script src="js/modules/NeuralNetOverlay.js"></script>

<script src="js/modules/SmallMultipleRenderer.js"></script>
<script src="js/modules/SmallMultipleOverlay.js"></script>
<script src="js/sm0.js"></script>

<script src="js/modules/LayerTransitionRenderer.js"></script>
<script src="js/modules/LayerTransitionOverlay.js"></script>

<script src="js/modules/LossHistoryRenderer.js"></script>


<script>
  utils.cacheAll(constants.preloadUrls);

  //Note: safari does not support window.requestIdleCallback
  if(window.requestIdleCallback){ 
    for (let url of constants.layerTransitionUrls['fashion-mnist']){
      window.requestIdleCallback(()=>{utils.cacheAll([url,] )});
    }
    for (let url of constants.adversarialUrls){
      window.requestIdleCallback(()=>{utils.cacheAll([url,] )});
    }
  }
  
  
  // window.requestIdleCallback(()=>{utils.cacheAll(constants.adversarialUrls)});
  // window.requestIdleCallback(()=>{utils.cacheAll(constants.layerTransitionUrls['fashion-mnist'])});
  // window.requestIdleCallback(()=>{utils.cacheAll(constants.layerTransitionUrls['mnist'])});
  // window.requestIdleCallback(()=>{utils.cacheAll(constants.layerTransitionUrls['cifar10'])});
  // 

  let allViews = [];// teaser, nn2, sm0, nngt, tesseract, se, dm1, nngt2, lt2, lta];
</script>

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="css/style.css">
<link rel="stylesheet" media="screen and (max-width: 1024px)" href="css/small-screen.css">

<style>
.nav{
  display: block;
}
</style>

<title>Dimension Bros</title>

</head>

<body>


<script>
  let c = utils.CLEAR_COLOR.map(d=>d*255);
  d3.selectAll('.flex-item')
  .style('background', d3.rgb(...c))
</script>

<d-article>


<i id="nngt-single-epoch-a"></i>

<d-figure class='nngt-single-epoch-1' style="border: 10px solid rgb(46, 46, 46); padding: 10px;">
  <canvas id='nngt-single-epoch-1' class='grandtour'></canvas>
  <script src='js/se1.js'></script>
  <script>   
    var panning = false;
    var oldMouseX = 0;
    var oldMouseY = 0;

    var mouseDownX = mouseDownY = 0;
    var requestDataPointClick = false;
    var requestDataPointX = 0;
    var requestDataPointY = 0;
   // hard coding the npoint is bad! but whatever.
    var selectedPointsArray
           = new Array(1000).fill(false);

    document.onmousedown = handleMouseDown;
    document.onmouseup = handleMouseUp;
    document.onmousemove = handleMouseMove;
    
    function handleMouseDown(e) {
      e = e || window.event;
      //console.log(e.pageX);
      //console.log(e.pageY);
      var graphMid = window.innerWidth/2;
      graphMid -= 48;
      var horOffset = 305;
      //var verOffset = 183;
      //console.log(graphMid + horOffset);

      if (e.pageX > graphMid - horOffset 
          && e.pageX < graphMid + horOffset  
          && e.pageY > 65 
          && e.pageY < 430) { // magic numbers roughly correlating to the graphs location
        panning = true;
      }
      mouseDownX = oldMouseX = e.pageX;
      mouseDownY = oldMouseY = e.pageY;
    }

    function handleMouseUp(e) {
      if(
           e.pageX - mouseDownX < 2
         &&
           e.pageY - mouseDownY < 2
         ){
        overlayPos = document.getElementsByClassName("overlay")[0].getBoundingClientRect();
       // console.log(
       //     mouseDownX - overlayPos.x,
       //     mouseDownY - overlayPos.y,
       //     );
            requestDataPointX = mouseDownX - overlayPos.x;
            requestDataPointY = mouseDownY - overlayPos.y;
        requestDataPointClick = true;
      }
      e = e || window.event;

      panning = false;
    }

    function handleMouseMove(e) {
      e = e || window.event;

      if (panning) {
        se1.xOffset += e.pageY-oldMouseY;
        se1.yOffset += e.pageX-oldMouseX;
      }
      oldMouseX = e.pageX;
      oldMouseY = e.pageY;
    }

    // arrow keys to pan
    document.onkeydown = (e) => {
      if (e.keyCode === 38) { //up
        se1.xOffset -= 10;
      } else if (e.keyCode === 40) { //down
        se1.xOffset += 10;
      } else if (e.keyCode === 37) { //left
        se1.yOffset -= 10;
      } else if (e.keyCode === 39) { //right
        se1.yOffset += 10;
      }
    };


    //Zoom in and out via scrool wheel  <- it's cool to scrool!

    window.addEventListener("wheel", event => {
      // scroll wheel no longer scrols pag
      event.preventDefault();
      const delta = Math.sign(event.deltaY);

      let zoomTickFac = 1.1;

      // offset plot while zooming
      overlayPos = document.getElementsByClassName("overlay")[0].getBoundingClientRect();
      overlayMidX = overlayPos.x + (overlayPos.width/2);
      overlayMidY = overlayPos.y + (overlayPos.height/2);
      mouseInOverlayX = event.pageX - overlayMidX +40;
      mouseInOverlayY = event.pageY - overlayMidY +20;
      
      oldXDelta = mouseInOverlayX - se1.yOffset; // x y switcherooo!
      oldYDelta = mouseInOverlayY - se1.xOffset;

      if (delta < 0) {

	      if (true){//se1.scaleFactor < 1000) { // max zoom (only go a little beyond it)
		// new zoom level
		se1.scaleFactor *= zoomTickFac; //up

		// new zoom offset
		newXDelta = zoomTickFac * oldXDelta;
		newYDelta = zoomTickFac * oldYDelta;

		se1.yOffset = mouseInOverlayX - newXDelta ;
		se1.xOffset = mouseInOverlayY - newYDelta ;
	}

      } else if (delta > 0) {
        if (se1.scaleFactor > 0.2) { //min zoom (only go a little less )
		// new zoom level
		se1.scaleFactor /= zoomTickFac; //down

		// new zoom offset
		newXDelta = oldXDelta / zoomTickFac;
		newYDelta = oldYDelta / zoomTickFac;

		se1.yOffset = mouseInOverlayX - newXDelta ;
		se1.xOffset = mouseInOverlayY - newYDelta ;
        }
      }

    // console.log(se1.scaleFactor); //

    }, {passive:false} // allow call to preventDefault cause there aint no scrolling on this page!
    );
    


    //  lets get wiggly!!!!

stillWiggling = false;
wiggleAxisIndex = 8;

function wiggle(){
	  dx = Math.sin(Date.now()/100)
	  dy = Math.cos(3.14/4 + Date.now()/100)

	matrix = window.se1.overlay.renderer.gt.getMatrix();
        
         matrix[wiggleAxisIndex][0] += .01*dx;
         matrix[wiggleAxisIndex][1] += .01*dy;

        
        matrix = utils.orthogonalize(matrix, wiggleAxisIndex);

        window.se1.overlay.renderer.gt.setMatrix(matrix);

        window.se1.overlay.redrawAxis();

        if(stillWiggling) setTimeout(wiggle, 50);
}

    
    </script>
</d-figure>
<figcaption>
  The Grand Tour of softmax layer, with 
  <a onclick="utils.setDataset('mnist');">MNIST</a>, 
  <a onclick="utils.setDataset('fashion-mnist');">fashion-MNIST</a> or 
  <a onclick="utils.setDataset('cifar10');">CIFAR-10</a> dataset.
  <br>
<a onclick="stillWiggling = !stillWiggling; wiggle();">Wiggle?</a>
<a onclick="wiggleAxisIndex= 0;">(0)</a>
<a onclick="wiggleAxisIndex= 1;">(1)</a>
<a onclick="wiggleAxisIndex= 2;">(2)</a>
<a onclick="wiggleAxisIndex= 3;">(3)</a>
<a onclick="wiggleAxisIndex= 4;">(4)</a>
<a onclick="wiggleAxisIndex= 5;">(5)</a>
<a onclick="wiggleAxisIndex= 6;">(6)</a>
<a onclick="wiggleAxisIndex= 7;">(7)</a>
<a onclick="wiggleAxisIndex= 8;">(8)</a>
<a onclick="wiggleAxisIndex= 9;">(9)</a>
<br> <a onclick="se1.overlay.initAxisHandle();">reload axis handles</a>
<br> <a onclick="se1.overlay.svg.anchors.attr('hidden',true);">hide axis handles</a>
<br> <a onclick="se1.dataObj.alphas.fill(255);">reset dp alphas</a>

</figcaption>



  </ul>
</p>


</d-article>



<script type="text/javascript" src="index.bundle.js"></script></body>
